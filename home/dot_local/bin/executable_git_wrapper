#!/bin/bash

convert_to_ssh() {
  local url="$1"
  if [[ "$url" =~ ^https://github\.com/([^/]+)/([^/]+)(\.git)?$ ]]; then
    local user="${BASH_REMATCH[1]}"
    local repo="${BASH_REMATCH[2]}"
    echo "git@github.com:${user}/${repo}.git"
  else
    echo "$url"
  fi
}

if [ "$1" == "clone" ] ; then
  ssh_url=$(convert_to_ssh "$2")
  command git clone "$ssh_url" "${@:3}"
  zoxide-index
else
  command git "$@"
fi
