{{ $taps := list -}}
{{ $casks := list -}}
{{ $mass_brew := list -}}
{{ $darwin_brew := list -}}
{{ $linux_brew := list -}}
{{ $pin_list := list -}}
{{ $cleanup_list := list -}}

{{ $taps = list
  "hashicorp/tap"
  "homebrew/autoupdate"
-}}

{{ $mass_brew = list
  "anomalyco/tap/opencode"
  "ansible"
  "apr-util"
  "atuin"
  "automake"
  "awscli"
  "bfg"
  "bison"
  "cask"
  "cloc"
  "cmake"
  "coreutils"
  "d2"
  "daisydisk"
  "devcontainer"
  "direnv"
  "eza"
  "fabric-ai"
  "fd"
  "ffmpeg"
  "fonttools"
  "fx"
  "fzf"
  "fzy"
  "gdbm"
  "gh"
  "gitbutler"
  "gnutls"
  "gpg"
  "graphviz"
  "htop"
  "hyperfine"
  "imagemagick"
  "jj"
  "joshmedeski/sesh/sesh"
  "jq"
  "k6"
  "keychain"
  "kubectl"
  "lazygit"
  "lazyjj"
  "lefthook"
  "libffi"
  "libfido2"
  "libyaml"
  "llvm@19"
  "md5deep"
  "mkdocs"
  "mockery"
  "mosh"
  "mysql-client@8.0"
  "newrelic-cli"
  "ninja"
  "noborus/tap/ov"
  "nushell"
  "nvim"
  "ollama"
  "openjdk"
  "openmtp"
  "overmind"
  "pkg-config"
  "postgresql"
  "posting"
  "pstree"
  "python"
  "rbspy"
  "readline"
  "redis"
  "ripgrep"
  "sqlite"
  "syncthing"
  "terrascan"
  "tflint"
  "tig"
  "tmux"
  "unbound"
  "unixodbc"
  "w3m"
  "watch"
  "wget"
  "zoxide"
-}}

{{ $casks = list
  "1password/tap/1password-cli"
  "alacritty"
  "alt-tab"
  "bartender"
  "betterdisplay"
  "busycal"
  "claude"
  "chatgpt"
  "cleanshot"
  "cursor"
  "font-hack-nerd-font"
  "ghostty@tip"
  "homerow"
  "karabiner-elements"
  "keycastr"
  "microsoft-teams"
  "mouseless"
  "nordvpn"
  "obsidian"
  "orbstack"
  "raycast"
  "slack"
  "spotify"
  "telegram"
  "todoist"
  "viber"
  "visual-studio-code"
  "whatsapp"
  "zen"
  "zoom"
-}}

{{- if (eq .personal true) -}}
  {{ $casks = concat $casks (list
       "figma"
       "font-sf-pro"
       "rapidapi"
       "sf-symbols"
    )
  }}
{{- else if (eq .work true) -}}
  {{ $casks = concat $casks (list
       "postman"
       "snowflake-snowsql"
    )
  }}
{{- end -}}

{{- $linux_brew = list
  "docker-compose"
  "openssh"
  "zsh"
-}}

{{- $darwin_brew = list
  "monodraw"
  "zed"
-}}

{{- $cleanup_list = list
  "fantastical"
-}}

#!/bin/bash

# brew update

{{ range $taps }}
brew tap {{ . }}
{{ end  }}

brew install {{ $mass_brew | join " " }}

{{ if (eq .chezmoi.os "darwin" | not) -}}
brew install {{ $linux_brew | join " " }}
{{ end -}}

{{ if (eq .chezmoi.os "darwin") -}}
{{ range $casks }}
  echo "brew install --cask {{ . }}"
  brew install --cask {{ . }}
{{ end }}

echo "brew install {{ $darwin_brew | join " " }}"
brew install {{ $darwin_brew | join " " }}
{{ end -}}

{{ if (len $pin_list | gt 0) -}}
brew pin {{ $pin_list | join " " }}
{{ end -}}

{{ range $cleanup_list }}
brew uninstall {{ . }} || echo "{{ . }} is already uninstalled"
{{ end -}}
