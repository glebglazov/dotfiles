{{ if (eq .chezmoi.os "linux") -}}

{{ $ppa_repos := list -}}

{{ $packages := list
  "fzf"
  "ripgrep"
  "git"
  "tig"
  "mosh"
  "tmux"
  "make"
  "wget"
  "curl"
  "pkg-config"
  "zsh"
  "jq"
  "keychain"
  "mosh"
  "direnv"
  "gnupg"
-}}

{{ if .workstation -}}
{{   $packages = concat $packages (list
       "software-properties-common"
       "docker.io"
       "docker-compose"
       "mysql-client"
       "nodejs"
       "npm"
       "libmysqlclient-dev") -}}
{{ end -}}

{{ $snaps := list "nvim" -}}

#!/bin/bash

set -eufo pipefail

{{ $sudo := "sudo " -}}
{{ if eq .chezmoi.username "root" -}}
{{ 	$sudo = "" -}}
{{ end -}}

{{ range $ppa_repos }}
{{ $sudo }}add-apt-repository -y {{ . }}
{{ end }}

{{ $sudo }}apt-get update
{{ $sudo }}apt-get install -y {{ $packages | join " " }}

{{ range $snaps }}
{{ $sudo }}snap install --classic {{ . }}
{{ end }}

chsh -s $(which zsh)

npm install --global yarn
{{ end -}}
